<!DOCTYPE html>
<html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Admin Cockpit</title>
<style>
  body{margin:0;background:#0b1020;color:#e5e7eb;font:16px/1.5 system-ui}
  .wrap{max-width:1100px;margin:auto;padding:20px}
  input,button{padding:8px 10px;border-radius:8px;border:1px solid #2b3b63;background:#0e162b;color:#e5e7eb}
  button{background:#2563eb;border-color:#1e3a8a;cursor:pointer}
  table{width:100%;border-collapse:collapse;margin-top:10px}
  th,td{border-bottom:1px solid #1f2a44;padding:8px;font-size:13px}
</style></head>
<body>
<div class="wrap">
  <h1>Admin Cockpit</h1>
  <div>
    <label>Admin token</label>
    <input id="tok" placeholder="paste ADMIN_TOKEN">
    <button id="load">Load</button>
  </div>
  <div style="margin-top:10px">
    <button id="opmMinus">OPM –</button>
    <button id="opmPlus">OPM +</button>
    <button id="agpMinus">AGP –</button>
    <button id="agpPlus">AGP +</button>
    <button id="sssMinus">SSS –</button>
    <button id="sssPlus">SSS +</button>
  </div>
  <pre id="counts"></pre>
  <table>
    <thead><tr><th>UUID</th><th>MC</th><th>Seat</th><th>Price</th><th>Name</th><th>Email</th><th>Company</th><th>Cohort</th><th>Time</th></tr></thead>
    <tbody id="rows"></tbody>
  </table>
</div>
<script>
const b3Yb5c722007KDlNrFcJcLsIpdaU0xH624qzcIe-14HVnbdsfjh6 = "https://st2s-enroll.<YOURNAME>.workers.dev"; // <-- replace

function auth(){ const t=document.getElementById('tok').value.trim(); return t?{'authorization':'Bearer '+t}:{ }; }
async function loadCounts(){ const j = await (await fetch(b3Yb5c722007KDlNrFcJcLsIpdaU0xH624qzcIe-14HVnbdsfjh6+'/api/counters')).json(); document.getElementById('counts').textContent=JSON.stringify(j,null,2); }
async function loadEnrollees(){
  const r = await fetch(b3Yb5c722007KDlNrFcJcLsIpdaU0xH624qzcIe-14HVnbdsfjh6+'/api/admin/enrollees',{headers:{...auth()}});
  if(r.status===401){ alert('Bad token'); return; }
  const j = await r.json(); const tb = document.getElementById('rows'); tb.innerHTML="";
  j.forEach(e=>{
    const tr = document.createElement('tr');
    const price = "€"+Math.round((e.price_cents||0)/100);
    const ts = new Date((e.created_at||0)*1000).toISOString();
    tr.innerHTML = `<td>${e.id}</td><td>${e.mc}</td><td>${e.seat}</td><td>${price}</td><td>${e.first||""} ${e.last||""}</td><td>${e.email||""}</td><td>${e.company||""}</td><td>${e.cohort||""}</td><td>${ts}</td>`;
    tb.appendChild(tr);
  });
}
async function adj(mc,delta){ await fetch(b3Yb5c722007KDlNrFcJcLsIpdaU0xH624qzcIe-14HVnbdsfjh6+'/api/admin/counter/adjust',{method:'POST',headers:{'content-type':'application/json',...auth()},body:JSON.stringify({mc,delta})}); loadCounts(); }

document.getElementById('load').onclick = ()=>{ loadCounts(); loadEnrollees(); };
document.getElementById('opmMinus').onclick=()=>adj('OPM',-1);
document.getElementById('opmPlus').onclick=()=>adj('OPM',1);
document.getElementById('agpMinus').onclick=()=>adj('AGP',-1);
document.getElementById('agpPlus').onclick=()=>adj('AGP',1);
document.getElementById('sssMinus').onclick=()=>adj('SSS',-1);
document.getElementById('sssPlus').onclick=()=>adj('SSS',1);
</script>
</body></html>
